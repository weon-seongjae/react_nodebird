{"version":3,"file":"static/webpack/static\\development\\pages\\hashtag.js.9e8144cd5f8e3c9ce3a3.hot-update.js","sources":["webpack:///./pages/hashtag.js"],"sourcesContent":["import React, {useCallback, useEffect} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport {LOAD_HASHTAG_POSTS_REQUEST, LOAD_MAIN_POSTS_REQUEST} from '../reducers/post';\r\nimport PostCard from '../components/PostCard';\r\n\r\nconst Hashtag = ({ tag }) => {\r\n  const dispatch = useDispatch();\r\n  const { mainPosts, hasMorePost } = useSelector(state => state.post);\r\n\r\n  const onScroll = useCallback(() => {\r\n    console.log(window.scrollY, document.documentElement.clientHeight, document.documentElement.scrollHeight);\r\n    // scrollY: 처음부터 제일 밑으로 내일 위치에서 상단까지의 높이(스크롤 내린 거리)\r\n    // clientHeight: 상단까지의 높이에서 스크롤을 제외한 하단까지의 높이(화면높이)\r\n    // scrollHeight: scrollY + clientHeight 값(전체 화면 길이)\r\n    if (window.scrollY + document.documentElement.clientHeight > document.documentElement.scrollHeight - 300) {\r\n      if(hasMorePost) {\r\n        dispatch({\r\n          type: LOAD_HASHTAG_POSTS_REQUEST,\r\n          lastId: mainPosts[mainPosts.length - 1].id,\r\n          data: tag,\r\n        })\r\n      }\r\n    }\r\n  },[hasMorePost, mainPosts.length]);\r\n\r\n  return (\r\n    <div>\r\n      {mainPosts.map(c => (\r\n        <PostCard key={c.id} post={c} />\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nHashtag.propTypes = {\r\n  tag: PropTypes.string.isRequired,\r\n};\r\n\r\nHashtag.getInitialProps = async (context) => { // next가 임의로 추가해준 lifecycle, getInitialProps가 제일 먼저 실행됨.\r\n  const tag = context.query.tag;\r\n  console.log('hashtag getInitialProps', tag);\r\n  context.store.dispatch({\r\n    type: LOAD_HASHTAG_POSTS_REQUEST,\r\n    data: tag,\r\n  });\r\n  return { tag: context.query.tag }; // _app.js로  tag 리턴, component의 props로 만들어줌.\r\n};\r\n\r\nexport default Hashtag;\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAFA;AAEA;AAAA;AAFA;AAAA;AACA;AAGA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AAEA;AAEA;AACA;AAAA;AAAA;AADA;AAKA;AACA;AACA;AACA;AADA;AACA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;AAHA;AAOA;AAAA;AACA;AARA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AASA;;;;A","sourceRoot":""}